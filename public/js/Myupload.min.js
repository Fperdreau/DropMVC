var getdrop=function(g){var d=g.dataTransfer||(g.originalEvent&&g.originalEvent.dataTransfer);var c=g.target.files||(d&&d.files);if(c){var a=c.length;for(var b=0;b<a;++b){var f=new FormData();f.append("file[]",c[b]);processUpl(f)}}};var processUpl=function(d,b){b=(b===undefined)?$(".upl_container"):b;var c=b.find(".upl_filelist");var a=(b.find("form").attr("action").length>0)?b.find("form").attr("action"):"upload.php";var e=new AnimateBack(b);jQuery.ajax({type:"POST",url:a,headers:{"Cache-Control":"no-cache"},data:d,contentType:false,processData:false,beforeSend:e.start(),complete:e.stop(),success:function(g){var f=jQuery.parseJSON(g);b.find(".upl_errors").hide();if(f.error===true){var j=$("#submit_form");var i=j.find('input[name="upl_link"]');if(i.length>0&&i!==undefined){var h=i.val();i.val(h+","+f.name)}else{j.append('<input type="hidden" name="upl_link" class="upl_link" value="'+f.name+'" />')}c.append(f.content)}else{b.find(".upl_errors").html(f.error).show()}},error:function(f){b.find(".upl_errors").html(f.statusText).show()}})};var sendAjax=function(d,c,e,a){a=(a===undefined)?"php/form.php":a;var b=new AnimateBack(d);jQuery.ajax({url:a,type:"POST",async:true,data:c,beforeSend:b.start(),complete:b.stop(),success:function(g){var f=jQuery.parseJSON(g);e(f)}})};function AnimateBack(a){this.el=a;this.interval=0;this.gradient_percent=0;this.interval_value=5;this.time_interval=50;this.timer=null;this.anim=function(){if(this.interval==20){this.interval=0;this.gradient_percent=0}this.gradient_percent+=this.interval_value;this.el.css("background","linear-gradient(to right, rgba(64,64,64,1) "+this.gradient_percent+"%,rgba(0,0,0,0) 100%)");this.interval++};this.start=function(){if(this.timer==null){this.timer=setInterval((function(b){return function(){b.anim()}})(this),this.time_interval)}};this.stop=function(){var b=this;if(b.timer!==null){setTimeout(function(){clearInterval(b.timer);b.el.css("background-color","rgba(68,68,68,1)");b.timer=null},1000)}}}$(document).ready(function(){var a=0;$(".mainbody").on("dragenter",".upl_container",function(b){b.stopPropagation();b.preventDefault();a++;$(".upl_container").addClass("dragging")}).on("dragleave",".upl_container",function(b){b.stopPropagation();b.preventDefault();a--;if(a===0){$(".upl_container").removeClass("dragging")}}).on("dragover",".upl_container",function(b){b.stopPropagation();b.preventDefault()}).on("drop",".upl_container",function(b){b.stopPropagation();b.preventDefault();getdrop(b);$(".upl_container").removeClass("dragging")}).on("click",".upl_btn",function(c){var b=$(this).closest(".upl_container");b.find(".upl_input").click()}).on("change",".upl_input",function(h){h.preventDefault();var b=$(this);var d=b.closest(".upl_container");var f=b[0];for(var c=0;c<f.files.length;++c){var g=new FormData();g.append("file[]",f.files[c]);processUpl(g,d)}}).on("click",".del_upl",function(f){f.preventDefault();var i=$(this);var h=i.attr("id");var b=(i.parent("a").attr("href")!==undefined&&i.parent("a").attr("href").length>0)?i.parent("a").attr("href"):"media/delete/"+h;var d={del_upl:true,uplname:h};var c=$(".upl_container");var g=function(e){if(e.status===true){$(".upl_info#upl_"+h).remove();$(".upl_link#upl_"+h).remove()}};sendAjax(c,d,g,b)})});