var displaypub=function(b,a){jQuery.ajax({url:"php/form.php",type:"POST",async:false,data:{show_pub:b},success:function(d){var c=jQuery.parseJSON(d);a.hide().html(c).fadeIn(200);tinyMCE.remove();window.tinymce.dom.Event.domLoaded=true;tinymcesetup()}})};var showpubform=function(b,a,c){if(c===undefined){c=false}$(".submission").remove();jQuery.ajax({url:b,type:"POST",async:false,data:{getpubform:c},success:function(e){var d=jQuery.parseJSON(e);a.hide().html(d).show();tinyMCE.remove();window.tinymce.dom.Event.domLoaded=true;tinymcesetup()}})};var displayToolForm=function(a,c,b){if(c===undefined){c=false}if(b===undefined){b=true}var d={gettoolform:c,form:b};var e=function(f){a.hide().html(f).show()};$(".submission").remove();processAjax(a,d,e)};var displayCvForm=function(b,a){if(a===undefined){a=false}$(".submission").remove();jQuery.ajax({url:"php/form.php",type:"POST",async:false,data:{getcvform:a},success:function(d){var c=jQuery.parseJSON(d);b.hide().html(c).show();tinyMCE.remove();window.tinymce.dom.Event.domLoaded=true;tinymcesetup()}})};var showpostform=function(c,b){b=(b!==undefined&&b!=="")?"/"+b:"";var a=(c===false)?"blog/edit":"blog/edit/"+c+b;jQuery.ajax({url:a,type:"POST",async:true,data:{post_show:true,postid:c},success:function(e){var d=jQuery.parseJSON(e);var f="<textarea name='content' id='post_content' class='tinymce'>"+d.content+"</textarea>";setTimeout(function(){$(".trad_form_container").empty().html(d.form).fadeIn(200);$(".tinymce_container").closest(".form-group").html(f).show();tinyMCE.remove();window.tinymce.dom.Event.domLoaded=true;tinymcesetup()},1000)}})};var logout=function(a){$(".warningmsg").remove();jQuery.ajax({url:a,type:"POST",success:function(){$(".mainbody").append("<div class='logoutWarning'>You have been logged out!</div>");$(".logoutWarning").fadeIn(200);setTimeout(function(){$(".logoutWarning").fadeOut(200).empty().hide();location.reload()},3000)}})};var session_timer=function(){jQuery.ajax({type:"post",url:"../auth/login_duration",success:function(a){var b=jQuery.parseJSON(a);console.log(b)}})};function animate_submenu(b,a){if(b.is(":visible")){b.animate({height:"toggle"},{duration:500,start:function(){$(".submenu").hide()},complete:function(){if(a!==undefined&&a.length>0){a.show();b.animate({height:"toggle"},500)}}})}}$(document).ready(function(){$(".mainbody").on("click","#cookie_consent_btn",function(b){b.preventDefault();var a=$(this).attr("href");jQuery.ajax({url:a,type:"post",success:function(){$("#cookie_consent_container").slideToggle()}})}).on("click",".menu",function(){var b=$(".sideMenu");if(!b.is(":visible")){var a=$("<div id='lean_overlay'></div>");$("body").append(a);$("#lean_overlay").css({display:"block",opacity:0}).fadeTo(200,0.5);b.animate({width:"toggle"});$("main").animate({left:"200px"})}else{$("#lean_overlay").hide();b.animate({width:"toggle"});$("main").animate({left:"0px"})}}).on("click",".submenu_trigger",function(c){c.preventDefault();var b=$(this).parent("li");var g=b.attr("id");var a=$(".submenu#"+g);var f=$("header #sub_menu");var d=$(".sideMenu .submenu#"+g);if($(this).closest("div").hasClass("sideMenu")){if(d.length===0){b.after(a);$(".sideMenu .submenu#"+g).hide()}a.slideToggle()}else{if(!a.is(":visible")){animate_submenu(f,a)}}return false}).on("click",".menu_section",function(d){d.preventDefault();var b=$(this).attr("href");var g=$(this).parent("li").attr("id");var c=g.split("/");var a=$(".submenu#"+c[c.length-1]);var f=$(".sideMenu");$("li").removeClass("activepage");$("a").removeClass("activepage");if(!a.is(":visible")&&a.length==0&&$(this).closest("#sub_menu").length==0){$(".submenu").hide()}$("li#"+c[0]).addClass("activepage");if(c.length>1){$("li #"+c[1]).addClass("activepage")}loadPageContent(b,c[0]);if(f.is(":visible")&&!$(this).hasClass("submenu_trigger")){$("#lean_overlay").hide();f.animate({width:"toggle"});$("main").animate({left:0})}return false}).on("click",function(b){var a=$(".menu");var d=$("nav");var c=$(".sideMenu");if(!a.is(b.target)&&a.has(b.target).length===0){if(c.is(":visible")&&!c.is(b.target)&&c.has(b.target).length===0){c.animate({width:"toggle"});$("main").animate({left:0})}}}).on("change",".ajax_select",function(d){d.preventDefault();var b=$(this).length>0?$($(this)[0].form):$();var a=b.attr("action");var c=b.serialize();jQuery.ajax({type:"post",url:a,data:c,success:function(){location.reload()}})}).on("click",".logout",function(b){b.preventDefault();var a=$(this).attr("href");logout(a)}).on("click",".show_customer_details",function(){tinymcesetup()}).on("click",".modify_login",function(c){c.preventDefault();var a=$(this);var b=a.length>0?$(a[0].form):$();var d=function(e){console.log(e);if(e.status===true){logout("../auth/logout")}};processForm(b,d)}).on("click",".gen_sitemap",function(b){b.preventDefault();var a=$(this).length>0?$($(this)[0].form):$();$("#sitemap_content").children().fadeOut();var c=function(d){$("#sitemap_content").html(d.content)};processForm(a,c)}).on("click",".input_rating",function(f){f.preventDefault();f.stopPropagation();var a=$(this);var c=a.length>0?$(a[0].form):$();var g=c.closest(".item_desc_ratings");var b=c.attr("action");var d=c.serializeArray();jQuery.ajax({type:"post",url:b,data:d,success:function(h){var e=jQuery.parseJSON(h);if(e.status==true){g.html(e.content)}}});return false}).on("mouseover",".item_desc_photo",function(){$(this).leanModal()}).on("click",".item_desc_photo",function(b){var a=$(this).find("img").attr("src");$(".modal_section#photo").html("<img src='"+a+"' class='picture_modal'>");show_section("photo")}).on("click",".input_rating",function(c){var a=$(this);var b=a.length>0?$(a[0].form):$();processForm(b)}).on("click",".item_modify_icon",function(){$(this).closest(".leanModal").click()}).on("mouseover",".delete",function(){$(this).leanModal()}).on("click",".delete",function(d){d.preventDefault();d.stopPropagation();var c=$(".modal_section#delete_confirmation");var f=$(this).data("id");var b=($(this).attr("href")===undefined)?$(this).data("url"):$(this).attr("href");var a=".el_to_del#"+f;c.find("input").remove();c.append("<input type='hidden' name='url' value='"+b+"'/>");c.append("<input type='hidden' name='el_id' value='"+a+"'/>");show_section("delete_confirmation")}).on("click",".confirm_delete",function(){var c=$(".modal_section#delete_confirmation");var a=$('input[name="el_id"]').val();var b=$('input[name="url"]').val();var d=function(e){if(e.status===true){close_modal();$(a).remove()}return false};processAjax(c,{},d,b)}).on("click",".item_thumb",function(){$(".item_thumb").removeClass("item_thumb_selected");$(this).addClass("item_thumb_selected");var a=$('select[name="photo"]');if(a.length>0&&a!==undefined){a.val($(this).data("id"))}}).on("mouseover",".item_thumb",function(){var b=$(this).find("img").attr("src");var a=$(".item_desc_photo");a.html('<img class="item_main_photo" src="'+b+'">')}).on("click",".type_add",function(g){g.preventDefault();var a=$(this);var f=a.length>0?$(a[0].form):$();var b=f.find('input[name="name"]').val();var c=a.data("div");var d=$(".type_list#"+c);var h=function(e){if(e.status===true){if(d.find(".icon_container#"+b).length==0){var i=e.content;d.append(i);close_modal()}f.find('input[name="name"]').empty()}};processForm(f,h)}).on("change",".filter_category",function(g){g.preventDefault();var a=$(this);var d=a.length>0?$(a[0].form):$();var b=d.attr("action");var c=$(".type_list#items");var f=d.serializeArray();jQuery.ajax({type:"post",url:b,data:f,success:function(h){var e=jQuery.parseJSON(h);if(e.status){c.hide().html(e.content).fadeIn(200)}}})}).on("click",".orders_headers",function(c){c.preventDefault();var b=$(this).find("a").attr("href");var a=$(this).closest(".filter_table_container");if(a===undefined){a=$("#pagecontent")}jQuery.ajax({url:b,type:"post",success:function(d){var e=jQuery.parseJSON(d);a.html(e.content)}})}).on("click","#paging_menu a",function(){var a=$(this).attr("href");loadPageContent(a)}).on("click",".load_edit",function(d){d.preventDefault();var b=$(this).length>0?$($(this)[0].form):$();var c=b.serialize();var a=b.attr("action");jQuery.ajax({type:"post",url:a,data:c,success:function(e){var f=jQuery.parseJSON(e);$(".editcontent").html(f);tinymcesetup()}})}).on("change",".select_lang",function(){var c=$(this).val();var a=$(this).data("url");var b=$(this).closest(".trad_form_container");jQuery.ajax({url:a+"/"+c,type:"post",success:function(d){var e=jQuery.parseJSON(d);b.html(e);tinymcesetup()}})}).on("click",".post_new",function(a){a.preventDefault();showpostform(false)}).on("click",".mail_preview",function(){var b=$(this).length>0?$($(this)[0].form):$();var c=b.serializeArray();var a=tinyMCE.get("message").getContent();c=modArray(c,"message",a);jQuery.ajax({type:"post",url:"../mail/preview",data:c,success:function(d){var e=jQuery.parseJSON(d);$(".mail_preview_container").html(e).fadeIn()}})}).on("click",".lang_trigger",function(){var a=$(this).attr("href");jQuery.ajax({url:a,type:"post",success:function(b){window.location.href=jQuery.parseJSON(b)}})}).on("click",".language_container #selected",function(d){d.preventDefault();var b=$(this).position();var c=$(".language_container #option_list");var a=$(this).outerHeight();$(this).css({border:"1px solid rgba(50, 50, 50, 1)"});c.css({position:"absolute",top:b.top+a+"px","z-index":999}).toggle()}).on("mouseenter",".tool_container",function(){$(this).find(".tool_desc").slideToggle(300)}).on("mouseleave",".tool_container",function(){$(this).find(".tool_desc").fadeOut(200)}).on("click","#modal_trigger_tool",function(a){a.preventDefault();displayToolForm(modalpubform)}).on("click","#modal_trigger_Modtool",function(b){b.preventDefault();b.stopPropagation();var a=$(this).attr("data-tool");displayToolForm(modalpubform,a)}).on("click",".toolformBtn",function(d){d.preventDefault();var a=$(this);var b=a.length>0?$(a[0].form):$();var f=function(e){if(e.status==true){setTimeout(function(){displayToolForm(b,false)},2000)}else{showfeedback(e.msg)}};var c=b.serialize();processAjax(b,c,f)}).on("click","#modal_trigger_cv",function(b){b.preventDefault();var a=$(this).attr("data-id");displayCvForm(modalpubform,a)}).on("click",".cvformBtn",function(c){c.preventDefault();var a=$(this).closest("#cvform");if(!checkform(a)){return false}var b=a.serialize();var d=function(e){if(e.status==true){setTimeout(function(){var f=$(".modal_section#cv_form");displayToolForm(f,false)},2000)}};processAjax(a,b,d)}).on("click",".delcvEl",function(f){f.preventDefault();var b=$(this).attr("href");var c=$(this).parent(".cvsubsection");var a=c.data("id");var d={delcvEl:a};var g=function(e){if(e.status==true){$("#cvEl_"+a).remove()}};processAjax(c,d,g,b)}).on("click",".modcvEl",function(f){f.preventDefault();var b=$(this).attr("href");console.log(b);var c=$(this).parent(".cvsubsection");var a=c.data("id");var d={delcvEl:a};jQuery.ajax({url:b,type:"post",success:function(g){var e=jquery.parseJSON(g);if(e.status==true){$("#cvEl_"+a).remove()}}})}).on("mouseover",".tinymce",function(){tinymcesetup()}).on("click",".addClick",function(d){var c=$(this).data("click");var b=$(this).data("id");var a=$(this).data("url");jQuery.ajax({url:a,type:"POST",async:true,data:{type:c,name:b}})}).on("click",".downloadpdf",function(g){g.preventDefault();var d=$(this);var c=d.find(".Btn_cv_icon");var h=d.closest(".cv_generate");var f=d.data("src");var b=d.attr("href");var a=c.html();jQuery.ajax({url:f,type:"get",beforeSend:function(){c.html("<div class='dl_btn pub_btn icon_btn'><img src='../public/images/small_loader.gif'></div>")},success:function(i){var e=jQuery.parseJSON(i);jQuery.ajax({url:b,type:"POST",data:{make_pdf:e.content},complete:function(){c.html(a)},success:function(k){var j=jQuery.parseJSON(k);h.after("<div class='cv_url' style='display: none;'><a href='"+j+"' target='_blank'>PDF</a></div>");h.next(".cv_url").animate({width:"toggle"})}})}})}).on("click",".login",function(c){c.preventDefault();var a=$(this);var b=a.length>0?$(a[0].form):$();var d=function(e){if(e.status===true){location.reload()}};processForm(b,d)}).on("click",".policies_toggle_content",function(b){b.preventDefault();var c=$(this).closest(".policies_section").attr("id");var a=$(this).attr("id");if(a==="on"){$(this).removeClass("toggle_on").addClass("toggle_off");$(this).attr("id","off")}else{$(this).removeClass("toggle_off").addClass("toggle_on");$(this).attr("id","on")}$(".policies_content#"+c).animate({height:"toggle"},500)}).on("click",".delete_ref",function(b){b.preventDefault();var a=$(this).attr("data-id");$(".modal_section#pub_delete").append('<input type=hidden id="del_pub" value="'+a+'"/>');show_section("pub_delete")}).on("click","#confirm_pubdel",function(d){d.preventDefault();var c=$("input#del_pub").val();var b={del_pub:c};var a=$(".modal_section#pub_delete");var f=function(e){if(e.status==true){close_modal(".modalContainer");$("#"+c).remove()}};processAjax(a,b,f)}).on("click",".pub_back_btn",function(){show_section("submission_form")}).on("click",".back_btn",function(a){a.preventDefault();show_section("user_login")}).on("click",".dl_btn",function(){var c=$(this);var b=c.outerHeight();var a=c.position();$(".dlmenu").css({position:"absolute",left:a.left+"px",top:a.top+b+"px"}).toggle(200)})});